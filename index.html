<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Veterinário</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f0f8ff 0%, #e6f7ff 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ESTILOS DA TELA DE LOGIN */
        #loginPage {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .login-container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
            padding: 30px;
            position: relative;
            overflow: hidden;
            transition: transform 0.5s ease, opacity 0.5s ease;
        }
        
        .login-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #2c7fb8, #7fcdbb);
        }
        
        .logo {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .logo-image {
            width: 120px;
            height: 120px;
            margin: 0 auto 15px;
            border-radius: 50%;
            background-color: #f0f8ff;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid #2c7fb8;
            overflow: hidden;
        }
        
        .logo-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .logo h1 {
            color: #2c7fb8;
            font-size: 26px;
            margin-bottom: 5px;
            font-weight: 700;
        }
        
        .logo p {
            color: #666;
            font-size: 15px;
        }
        
        .login-form {
            display: flex;
            flex-direction: column;
        }
        
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 14px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: #2c7fb8;
            outline: none;
            box-shadow: 0 0 0 3px rgba(44, 127, 184, 0.2);
        }
        
        .password-container {
            position: relative;
        }
        
        .toggle-password {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: #666;
            padding: 5px;
        }
        
        .toggle-password:hover {
            color: #2c7fb8;
        }
        
        .btn-login {
            background: linear-gradient(to right, #2c7fb8, #7fcdbb);
            color: white;
            border: none;
            padding: 14px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            box-shadow: 0 4px 10px rgba(44, 127, 184, 0.3);
        }
        
        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(44, 127, 184, 0.4);
        }
        
        /* NOVO ESTILO PARA O BOTÃO DO LABORATÓRIO */
        .btn-laboratory {
            background: linear-gradient(to right, #9c27b0, #673ab7);
            color: white;
            border: none;
            padding: 14px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            box-shadow: 0 4px 10px rgba(156, 39, 176, 0.3);
            display: none; /* Inicialmente oculto */
            width: 100%;
        }

        .btn-laboratory:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(156, 39, 176, 0.4);
        }
        
        .permissions-info {
            margin-top: 25px;
            padding: 18px;
            background-color: #f8f9fa;
            border-radius: 8px;
            font-size: 14px;
            border-left: 4px solid #2c7fb8;
        }
        
        .permissions-info h3 {
            color: #2c7fb8;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .permissions-info ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        .permissions-info li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }
        
        .permissions-info li:before {
            content: "•";
            color: #2c7fb8;
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        
        .error-message {
            color: #e74c3c;
            font-size: 14px;
            margin-top: 10px;
            text-align: center;
            display: none;
            padding: 10px;
            background-color: #ffeaea;
            border-radius: 5px;
        }
        
        .success-message {
            color: #27ae60;
            font-size: 14px;
            margin-top: 10px;
            text-align: center;
            display: none;
            padding: 10px;
            background-color: #eafaf1;
            border-radius: 5px;
        }
        
        .password-hint {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
        
        .footer {
            text-align: center;
            margin-top: 20px;
            color: #888;
            font-size: 12px;
        }
        
        /* TELA DE TRANSIÇÃO */
        #welcomePage {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2c7fb8 0%, #7fcdbb 100%);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: white;
            text-align: center;
        }
        
        .welcome-container {
            max-width: 600px;
            padding: 40px;
            animation: fadeInUp 1s ease-out;
        }
        
        .welcome-logo {
            width: 150px;
            height: 150px;
            margin: 0 auto 30px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 4px solid rgba(255, 255, 255, 0.3);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .welcome-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .welcome-title {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            opacity: 0;
            animation: fadeIn 0.8s ease 0.5s forwards;
            text-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .welcome-subtitle {
            font-size: 1.8rem;
            margin-bottom: 40px;
            opacity: 0;
            animation: fadeIn 0.8s ease 1s forwards;
            font-weight: 300;
        }
        
        .welcome-user {
            font-size: 2.2rem;
            font-weight: 600;
            margin-bottom: 30px;
            opacity: 0;
            animation: fadeIn 0.8s ease 1.5s forwards;
            color: #ffeb3b;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .loading-bar {
            width: 300px;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            margin: 30px auto;
            opacity: 0;
            animation: fadeIn 0.8s ease 2s forwards;
        }
        
        .loading-progress {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #ffeb3b, #ff9800);
            border-radius: 10px;
            animation: loading 2.5s ease 2.2s forwards;
        }
        
        .welcome-message {
            font-size: 1.2rem;
            opacity: 0;
            animation: fadeIn 0.8s ease 2.5s forwards;
            margin-top: 20px;
            font-weight: 300;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes loading {
            0% {
                width: 0%;
            }
            100% {
                width: 100%;
            }
        }
        
        /* ESTILOS DA TELA DE ARQUIVOS */
        #filesPage {
            display: none;
            min-height: 100vh;
            padding: 20px;
            animation: fadeIn 0.8s ease;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #2c7fb8;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-image-small {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 2px solid #2c7fb8;
            overflow: hidden;
        }
        
        .logo-image-small img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .logo-text h1 {
            color: #2c7fb8;
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .logo-text p {
            color: #666;
            font-size: 14px;
        }
        
        .user-info {
            text-align: right;
        }
        
        .user-info span {
            color: #2c7fb8;
            font-weight: 600;
        }
        
        .btn-logout {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 5px;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn-logout:hover {
            background: #c0392b;
        }
        
        .main-container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .page-title {
            color: #2c7fb8;
            margin-bottom: 25px;
            font-size: 28px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .page-title svg {
            width: 30px;
            height: 30px;
        }
        
        .actions-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .search-box {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 8px 15px;
            width: 300px;
        }
        
        .search-box input {
            border: none;
            background: transparent;
            padding: 8px;
            width: 100%;
            outline: none;
        }
        
        .search-box svg {
            color: #666;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #2c7fb8;
            color: white;
        }
        
        .btn-primary:hover {
            background: #1d5f8a;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #7fcdbb;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5bbfa5;
            transform: translateY(-2px);
        }
        
        .alphabet-filter {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .letter-btn {
            width: 35px;
            height: 35px;
            border: none;
            border-radius: 50%;
            background: white;
            color: #2c7fb8;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .letter-btn:hover, .letter-btn.active {
            background: #2c7fb8;
            color: white;
        }
        
        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .file-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            border-left: 4px solid #2c7fb8;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }
        
        .file-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        
        .horse-name {
            color: #2c7fb8;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .horse-details {
            color: #666;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .horse-details div {
            margin-bottom: 5px;
        }
        
        .file-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-small {
            padding: 6px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }
        
        .btn-edit {
            background: #f39c12;
            color: white;
        }
        
        .btn-edit:hover {
            background: #e67e22;
        }
        
        .btn-pdf {
            background: #e74c3c;
            color: white;
        }
        
        .btn-pdf:hover {
            background: #c0392b;
        }
        
        .no-results {
            text-align: center;
            padding: 40px;
            color: #666;
            grid-column: 1 / -1;
        }
        
        /* MODAL DETALHES DO CAVALO */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 1000px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-title {
            color: #2c7fb8;
            font-size: 22px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }
        
        .horse-detail-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .detail-section {
            margin-bottom: 25px;
        }
        
        .detail-section h3 {
            color: #2c7fb8;
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .detail-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }
        
        .detail-info p {
            margin-bottom: 10px;
            color: #555;
        }
        
        .detail-info p:last-child {
            margin-bottom: 0;
        }
        
        .prescription-section {
            margin-top: 30px;
            border-top: 2px solid #eee;
            padding-top: 20px;
        }
        
        .prescription-list {
            margin-bottom: 25px;
        }
        
        .prescription-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #2c7fb8;
            position: relative;
        }
        
        .prescription-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .medication-name {
            font-weight: 600;
            color: #2c7fb8;
            font-size: 16px;
        }
        
        .medication-dosage {
            color: #666;
            font-size: 14px;
        }
        
        .prescription-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }
        
        .btn-delete {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .btn-delete:hover {
            background: #c0392b;
        }
        
        .medication-schedule {
            margin-top: 10px;
        }
        
        .schedule-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }
        
        .days-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-top: 10px;
        }
        
        .day-box {
            width: 35px;
            height: 35px;
            border: 2px solid #ddd;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            position: relative;
        }
        
        .day-box.applied {
            background: #27ae60;
            color: white;
            border-color: #27ae60;
        }
        
        .day-box.not-applied {
            background: #e74c3c;
            color: white;
            border-color: #e74c3c;
        }
        
        .day-box:hover {
            transform: scale(1.1);
        }
        
        .day-label {
            font-size: 12px;
            color: #666;
            text-align: center;
            margin-top: 5px;
        }
        
        .day-status {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            font-size: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .add-prescription {
            margin-top: 20px;
            padding: 15px;
            background: #e6f7ff;
            border-radius: 8px;
            border: 2px dashed #2c7fb8;
        }
        
        .add-prescription-btn {
            background: #2c7fb8;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .add-prescription-btn:hover {
            background: #1d5f8a;
        }
        
        .prescription-form {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 500;
            font-size: 14px;
        }
        
        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 25px;
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .user-info {
                text-align: center;
            }
            
            .actions-bar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                width: 100%;
            }
            
            .horse-detail-grid {
                grid-template-columns: 1fr;
            }
            
            .days-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .welcome-title {
                font-size: 2.5rem;
            }
            
            .welcome-subtitle {
                font-size: 1.4rem;
            }
            
            .welcome-user {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- TELA DE LOGIN -->
    <div id="loginPage">
        <div class="login-container">
            <div class="logo">
                <div class="logo-image">
                    <img src="2-rcg-926x926 (1).jpg" alt="Logo Veterinária">
                </div>
                <h1>Vet 2°rcg System</h1>
                <p>Sistema de Gestão Veterinária</p>
            </div>
            
            <form class="login-form" id="loginForm">
                <div class="form-group">
                    <label for="role">Cargo</label>
                    <select id="role" required>
                        <option value="">Selecione seu cargo</option>
                        <option value="admin">Administrador (Ten)</option>
                        <option value="moderador">Moderador (Aux, Enf)</option>
                        <option value="visitante">Visitante (Estagiário)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="username">Usuário</label>
                    <input type="text" id="username" placeholder="Digite seu usuário" required>
                    <select id="adminUsers" style="display: none; margin-top: 10px;">
                        <option value="">Selecione um administrador</option>
                        <option value="Maj. Cristovam">Maj. Cristovam</option>
                        <option value="Ten. Henrique">Ten. Henrique</option>
                        <option value="Ten. Thayanne">Ten. Espinho</option>
                        <option value="Ten. Andressa">Ten. Aragon</option>
                        <option value="Ten. Espinho">Ten. Andressa Alves</option>
                        <option value="Ten. Henrique">Ten. Thayanne Mara</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="password">Senha</label>
                    <div class="password-container">
                        <input type="password" id="password" placeholder="Digite a senha do seu cargo" required>
                        <button type="button" class="toggle-password" id="togglePassword">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    <div class="password-hint" id="passwordHint"></div>
                </div>
                
                <button type="submit" class="btn-login">Entrar no Sistema</button>

                <!-- NOVO BOTÃO LABORATÓRIO -->
                <button type="button" class="btn-laboratory" id="btnLaboratory">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.5 12H22.5M19.5 12L16.5 15M19.5 12L16.5 9M4.5 12H1.5M4.5 12L7.5 15M4.5 12L7.5 9M12 1.5V4.5M12 1.5L9 4.5M12 1.5L15 4.5M12 22.5V19.5M12 22.5L9 19.5M12 22.5L15 19.5M20 12C20 16.4183 16.4183 20 12 20C7.58172 20 4 16.4183 4 12C4 7.58172 7.58172 4 12 4C16.4183 4 20 7.58172 20 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Acessar Laboratório
                </button>
                
                <div class="error-message" id="errorMessage">
                    Senha incorreta para este cargo. Tente novamente.
                </div>
                
                <div class="success-message" id="successMessage">
                    Login realizado com sucesso! Redirecionando...
                </div>
            </form>
            
            <div class="permissions-info">
                <h3>Permissões do Sistema</h3>
                <ul>
                    <li><strong>Administrador (Ten):</strong> Acesso total ao sistema</li>
                    <li><strong>Moderador (Aux, Enf):</strong> Acesso a fichas e registros</li>
                    <li><strong>Visitante (Estagiário):</strong> Acesso limitado para consulta</li>
                </ul>
            </div>
            
            <div class="footer">
                &copy; 2025 Vet2°rcg System - Todos os direitos reservados
            </div>
        </div>
    </div>

    <!-- TELA DE TRANSIÇÃO -->
    <div id="welcomePage">
        <div class="welcome-container">
            <div class="welcome-logo">
                <img src="2-rcg-926x926 (1).jpg" alt="Logo Veterinária">
            </div>
            <h1 class="welcome-title">Bem-vindo(a)</h1>
            <h2 class="welcome-subtitle">ao Vet2°rcg System</h2>
            <div class="welcome-user" id="welcomeUserName"></div>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
            <p class="welcome-message">Carregando seus arquivos...</p>
        </div>
    </div>

    <!-- TELA DE ARQUIVOS -->
    <div id="filesPage">
        <div class="header">
            <div class="logo-section">
                <div class="logo-image-small">
                    <img src="2-rcg-926x926 (1).jpg" alt="Logo Veterinária">
                </div>
                <div class="logo-text">
                    <h1>Vet 2°rcg System</h1>
                    <p>Sistema de Gestão Veterinária</p>
                </div>
            </div>
            <div class="user-info">
                <p>Logado como: <span id="loggedUser">Administrador</span></p>
                <button class="btn-logout" id="btnLogout">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16 17L21 12L16 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M21 12H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Sair
                </button>
            </div>
        </div>
        
        <div class="main-container">
            <h1 class="page-title">
                <svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M14 2V8H20" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M16 13H8" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M16 17H8" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M10 9H9H8" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Arquivos de Cavalos
            </h1>
            
            <div class="actions-bar">
                <div class="search-box">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 21L16.514 16.506L21 21ZM19 10.5C19 15.194 15.194 19 10.5 19C5.806 19 2 15.194 2 10.5C2 5.806 5.806 2 10.5 2C15.194 2 19 5.806 19 10.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <input type="text" id="searchInput" placeholder="Buscar cavalo...">
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="btnAddHorse">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 5V19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Adicionar Cavalo
                    </button>
                    <button class="btn btn-secondary" id="btnExportAll">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Exportar Todos
                    </button>
                </div>
            </div>
            
            <div class="alphabet-filter" id="alphabetFilter">
                <!-- As letras serão geradas via JavaScript -->
            </div>
            
            <div class="files-grid" id="filesGrid">
                <!-- Os arquivos serão gerados via JavaScript -->
            </div>
        </div>
    </div>
    
    <!-- Modal para Adicionar/Editar Cavalo -->
    <div class="modal" id="horseModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Adicionar Novo Cavalo</h2>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            
            <form id="horseForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="horseName">Nome do Cavalo</label>
                        <input type="text" id="horseName" required>
                    </div>
                    <div class="form-group">
                        <label for="horseId">Identificação</label>
                        <input type="text" id="horseId" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="horseBreed">Raça</label>
                        <input type="text" id="horseBreed" required>
                    </div>
                    <div class="form-group">
                        <label for="horseAge">Idade</label>
                        <input type="text" id="horseAge" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="horseColor">Cor</label>
                        <input type="text" id="horseColor" required>
                    </div>
                    <div class="form-group">
                        <label for="horseSex">Sexo</label>
                        <select id="horseSex" required>
                            <option value="">Selecione</option>
                            <option value="Macho">Macho</option>
                            <option value="Fêmea">Fêmea</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="horseOwner">Proprietário</label>
                    <input type="text" id="horseOwner" required>
                </div>
                
                <div class="form-group">
                    <label for="horseHistory">Histórico Médico</label>
                    <textarea id="horseHistory" rows="4"></textarea>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="btnCancel">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="btnSave">Salvar Ficha</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal Detalhes do Cavalo -->
    <div class="modal" id="horseDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="horseDetailTitle">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 16H9M14 12H11M12 21C12.9465 21 13.8734 20.7716 14.7087 20.3343C15.544 19.897 16.2623 19.2643 16.8 18.492C17.7895 17.1277 19.8333 14.8 21 13C21.3333 12.3333 22 10.8 22 8.5C22 5.5 20.5 3 17.5 3C15.8333 3 14.5 4.5 14.5 4.5C14.5 4.5 13.5 3 11.5 3C9.5 3 8.5 4 8.5 6C8.5 6 7.5 5 5.5 5C3.5 5 2 7 2 9.5C2 12.5 3.5 14.5 5.5 16.5C7.5 18.5 9.66667 19.3333 11 19.5C11.5 19.6 12 19.5 12 19.5Z" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Detalhes do Cavalo
                </h2>
                <button class="close-modal" id="closeDetailModal">&times;</button>
            </div>
            
            <div class="horse-detail-grid" id="horseDetailContent">
                <!-- Conteúdo será preenchido via JavaScript -->
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" id="btnCloseDetail">Fechar</button>
                <button type="button" class="btn btn-primary" id="btnEditHorse">Editar Ficha</button>
            </div>
        </div>
    </div>

    <script>
        // ========== CONFIGURAÇÕES DE LOGIN ==========
        // Senhas para cada tipo de permissão
        const passwords = {
            'admin': 'admin123',
            'moderador': 'mod456',
            'visitante': 'estag789'
        };
        
        // Dicas de senha para cada cargo
        const passwordHints = {
            'admin': 'Use a senha do Administrador',
            'moderador': 'Use a senha do Moderador',
            'visitante': 'Use a senha do Visitante'
        };
        
        // Lista de administradores
        const adminUsers = [
            'Maj. Cristovam',
            'Ten. Henrique', 
            'Ten. Thayanne',
            'Ten. Andressa',
            'Ten. Espinho'
        ];
        
        // ========== DADOS DOS CAVALOS ==========
        let horses = [
            { 
                id: 1, 
                name: "Gastador", 
                breed: "Quarto de Milha", 
                age: "7 anos", 
                color: "Alazão", 
                sex: "Macho", 
                owner: "Escola do exército", 
                history: "Pós cirúrgico. Última consulta: 15/11/2025",
                prescriptions: [
                    {
                        id: 1,
                        medication: "Anti-inflamatório",
                        dosage: "1 comprimido",
                        frequency: "2 vezes ao dia",
                        duration: 7,
                        startDate: "2025-01-15",
                        medicationDays: [
                            { day: 1, status: "applied" },
                            { day: 2, status: "applied" },
                            { day: 3, status: "not-applied" },
                            { day: 4, status: null },
                            { day: 5, status: null },
                            { day: 6, status: null },
                            { day: 7, status: null }
                        ]
                    },
                    {
                        id: 2,
                        medication: "Vitamina E",
                        dosage: "500mg",
                        frequency: "1 vez ao dia",
                        duration: 14,
                        startDate: "2025-01-10",
                        medicationDays: [
                            { day: 1, status: "applied" },
                            { day: 2, status: "applied" },
                            { day: 3, status: "applied" },
                            { day: 4, status: "applied" },
                            { day: 5, status: "applied" },
                            { day: 6, status: "applied" },
                            { day: 7, status: "applied" },
                            { day: 8, status: "not-applied" },
                            { day: 9, status: null },
                            { day: 10, status: null },
                            { day: 11, status: null },
                            { day: 12, status: null },
                            { day: 13, status: null },
                            { day: 14, status: null }
                        ]
                    }
                ]
            },
            { 
                id: 2, 
                name: "Afeição", 
                breed: "Mangalarga", 
                age: "5 anos", 
                color: "Tordilho", 
                sex: "Fêmea", 
                owner: "Escola de equitação", 
                history: "Problema articular tratado em 2024. Controle semestral.",
                prescriptions: [
                    {
                        id: 1,
                        medication: "Suplemento articular",
                        dosage: "2 comprimidos",
                        frequency: "1 vez ao dia",
                        duration: 30,
                        startDate: "2025-01-01",
                        medicationDays: Array.from({length: 30}, (_, i) => ({ 
                            day: i + 1, 
                            status: i < 14 ? "applied" : null 
                        }))
                    }
                ]
            },
            { 
                id: 3, 
                name: "Gallen", 
                breed: "Crioulo", 
                age: "10 anos", 
                color: "Preto", 
                sex: "Fêmea", 
                owner: "2rcg", 
                history: "Histórico de cólica. Dieta controlada.",
                prescriptions: []
            },
            { 
                id: 4, 
                name: "Janeiro", 
                breed: "Puro Sangue Inglês", 
                age: "4 anos", 
                color: "Tordilho", 
                sex: "Macho", 
                owner: "Jóquei Clube", 
                history: "Atleta em treinamento. Acompanhamento mensal.",
                prescriptions: []
            },
            { 
                id: 5, 
                name: "Branca", 
                breed: "Andaluz", 
                age: "12 anos", 
                color: "Branco", 
                sex: "Fêmea", 
                owner: "Centro Equestre", 
                history: "Parte do programa de equoterapia. Saúde excelente.",
                prescriptions: []
            },
            { 
                id: 6, 
                name: "Bruxo", 
                breed: "Árabe", 
                age: "8 anos", 
                color: "Tordilho", 
                sex: "Macho", 
                owner: "Capitão Godoy", 
                history: "Problema respiratório controlado com medicação.",
                prescriptions: []
            }
        ];
        
        // ========== ELEMENTOS DO DOM ==========
        // Login
        const loginPage = document.getElementById('loginPage');
        const welcomePage = document.getElementById('welcomePage');
        const filesPage = document.getElementById('filesPage');
        const roleSelect = document.getElementById('role');
        const usernameInput = document.getElementById('username');
        const adminUsersSelect = document.getElementById('adminUsers');
        const passwordInput = document.getElementById('password');
        const passwordHint = document.getElementById('passwordHint');
        const togglePassword = document.getElementById('togglePassword');
        const errorMessage = document.getElementById('errorMessage');
        const successMessage = document.getElementById('successMessage');
        const loginForm = document.getElementById('loginForm');
        const welcomeUserName = document.getElementById('welcomeUserName');
        const btnLaboratory = document.getElementById('btnLaboratory'); // NOVO ELEMENTO
        
        // Arquivos
        const alphabetFilter = document.getElementById('alphabetFilter');
        const filesGrid = document.getElementById('filesGrid');
        const searchInput = document.getElementById('searchInput');
        const btnAddHorse = document.getElementById('btnAddHorse');
        const btnExportAll = document.getElementById('btnExportAll');
        const horseModal = document.getElementById('horseModal');
        const closeModal = document.getElementById('closeModal');
        const btnCancel = document.getElementById('btnCancel');
        const horseForm = document.getElementById('horseForm');
        const modalTitle = document.getElementById('modalTitle');
        const btnLogout = document.getElementById('btnLogout');
        const loggedUser = document.getElementById('loggedUser');
        
        // Detalhes do cavalo
        const horseDetailModal = document.getElementById('horseDetailModal');
        const horseDetailTitle = document.getElementById('horseDetailTitle');
        const horseDetailContent = document.getElementById('horseDetailContent');
        const closeDetailModal = document.getElementById('closeDetailModal');
        const btnCloseDetail = document.getElementById('btnCloseDetail');
        const btnEditHorse = document.getElementById('btnEditHorse');
        
        let currentHorseId = null;
        let currentFilter = 'all';
        let currentUser = '';
        let showPrescriptionForm = false;
        
        // ========== FUNÇÕES DE LOGIN ==========
        // Alternar entre input de texto e select para administradores
        roleSelect.addEventListener('change', function() {
            const selectedRole = this.value;
            
            // Limpar mensagens de erro/sucesso
            errorMessage.style.display = 'none';
            successMessage.style.display = 'none';
            
            // Atualizar dica de senha
            if (selectedRole && passwordHints[selectedRole]) {
                passwordHint.textContent = passwordHints[selectedRole];
            } else {
                passwordHint.textContent = '';
            }
            
            // Mostrar/ocultar select de administradores
            if (selectedRole === 'admin') {
                usernameInput.style.display = 'none';
                adminUsersSelect.style.display = 'block';
                adminUsersSelect.required = true;
                usernameInput.required = false;
            } else {
                usernameInput.style.display = 'block';
                adminUsersSelect.style.display = 'none';
                usernameInput.required = true;
                adminUsersSelect.required = false;
                usernameInput.value = '';
            }
            
            // Limpar seleção do select de administradores
            adminUsersSelect.value = '';
            
            // Ocultar botão do laboratório quando mudar o cargo
            btnLaboratory.style.display = 'none';
        });
        
        // Preencher automaticamente o campo de usuário quando selecionar um administrador
        adminUsersSelect.addEventListener('change', function() {
            if (this.value) {
                usernameInput.value = this.value;
                
                // Mostrar botão do laboratório apenas para "Ten. Andressa"
                if (this.value === "Ten. Andressa") {
                    btnLaboratory.style.display = 'block';
                } else {
                    btnLaboratory.style.display = 'none';
                }
            } else {
                btnLaboratory.style.display = 'none';
            }
        });
        
        // Alternar visibilidade da senha
        togglePassword.addEventListener('click', function() {
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            
            // Alterar ícone do olho
            if (type === 'text') {
                this.innerHTML = `
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17.94 17.94C16.2306 19.243 14.1491 19.9649 12 20C5 20 1 12 1 12C2.24389 9.68192 3.96914 7.65663 6.06 6.06006M9.9 4.24006C10.5883 4.0789 11.2931 3.99836 12 4.00006C19 4.00006 23 12 23 12C22.393 13.1356 21.6691 14.2048 20.84 15.19M14.12 14.12C13.8454 14.4148 13.5141 14.6512 13.1462 14.8151C12.7782 14.9791 12.3809 15.0673 11.9781 15.0744C11.5753 15.0815 11.1752 15.0074 10.8016 14.8565C10.4281 14.7056 10.0887 14.4811 9.80385 14.1962C9.51897 13.9113 9.29439 13.572 9.14351 13.1984C8.99262 12.8249 8.91853 12.4247 8.92563 12.0219C8.93274 11.6191 9.02091 11.2219 9.18488 10.8539C9.34884 10.4859 9.58525 10.1547 9.88 9.88006" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M1 1L23 23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                `;
            } else {
                this.innerHTML = `
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                `;
            }
        });
        
        // Processar o formulário de login
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const role = document.getElementById('role').value;
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // Validar se todos os campos foram preenchidos
            if (!role) {
                errorMessage.textContent = 'Por favor, selecione um cargo.';
                errorMessage.style.display = 'block';
                successMessage.style.display = 'none';
                return;
            }
            
            if (!username) {
                errorMessage.textContent = 'Por favor, preencha o usuário.';
                errorMessage.style.display = 'block';
                successMessage.style.display = 'none';
                return;
            }
            
            if (!password) {
                errorMessage.textContent = 'Por favor, preencha a senha.';
                errorMessage.style.display = 'block';
                successMessage.style.display = 'none';
                return;
            }
            
            // Verificar se a senha está correta para o cargo selecionado
            if (password === passwords[role]) {
                // Login bem-sucedido
                errorMessage.style.display = 'none';
                successMessage.style.display = 'block';
                currentUser = username;
                
                // Redirecionar para a tela de boas-vindas após 1 segundo
                setTimeout(function() {
                    showWelcomePage();
                }, 1000);
            } else {
                // Senha incorreta
                errorMessage.textContent = 'Senha incorreta para este cargo. Tente novamente.';
                errorMessage.style.display = 'block';
                successMessage.style.display = 'none';
            }
        });
        
        // ========== FUNÇÕES DE TRANSIÇÃO ==========
        // Mostrar tela de boas-vindas
        function showWelcomePage() {
            loginPage.style.display = 'none';
            welcomePage.style.display = 'flex';
            welcomeUserName.textContent = currentUser;
            
            // Redirecionar para a tela de arquivos após a animação (4.5 segundos)
            setTimeout(function() {
                showFilesPage();
            }, 4500);
        }
        
        // Mostrar tela de arquivos
        function showFilesPage() {
            welcomePage.style.display = 'none';
            filesPage.style.display = 'block';
            loggedUser.textContent = currentUser;
            generateAlphabetFilter();
            renderHorses();
        }
        
        // Voltar para tela de login
        function showLoginPage() {
            filesPage.style.display = 'none';
            loginPage.style.display = 'flex';
            loginForm.reset();
            errorMessage.style.display = 'none';
            successMessage.style.display = 'none';
            passwordHint.textContent = '';
            usernameInput.style.display = 'block';
            adminUsersSelect.style.display = 'none';
            btnLaboratory.style.display = 'none';
        }
        
        // ========== FUNÇÕES DA TELA DE ARQUIVOS ==========
        // Gerar filtro alfabético
        function generateAlphabetFilter() {
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
            alphabetFilter.innerHTML = '';
            
            // Botão "Todos"
            const allButton = document.createElement('button');
            allButton.className = 'letter-btn active';
            allButton.textContent = 'TODOS';
            allButton.addEventListener('click', () => filterHorsesByLetter('all'));
            alphabetFilter.appendChild(allButton);
            
            // Botões para cada letra
            letters.forEach(letter => {
                const button = document.createElement('button');
                button.className = 'letter-btn';
                button.textContent = letter;
                button.addEventListener('click', () => filterHorsesByLetter(letter));
                alphabetFilter.appendChild(button);
            });
        }
        
        // Filtrar cavalos por letra
        function filterHorsesByLetter(letter) {
            currentFilter = letter;
            
            // Atualizar botões ativos
            document.querySelectorAll('.letter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.querySelectorAll('.letter-btn').forEach(btn => {
                if (btn.textContent === letter || (letter === 'all' && btn.textContent === 'TODOS')) {
                    btn.classList.add('active');
                }
            });
            
            renderHorses();
        }
        
        // Renderizar lista de cavalos
        function renderHorses() {
            filesGrid.innerHTML = '';
            
            let filteredHorses = [...horses];
            
            // Aplicar filtro alfabético
            if (currentFilter !== 'all') {
                filteredHorses = filteredHorses.filter(horse => 
                    horse.name.toUpperCase().startsWith(currentFilter)
                );
            }
            
            // Aplicar filtro de busca
            const searchTerm = searchInput.value.toLowerCase();
            if (searchTerm) {
                filteredHorses = filteredHorses.filter(horse => 
                    horse.name.toLowerCase().includes(searchTerm) ||
                    horse.breed.toLowerCase().includes(searchTerm) ||
                    horse.owner.toLowerCase().includes(searchTerm)
                );
            }
            
            // Ordenar alfabeticamente
            filteredHorses.sort((a, b) => a.name.localeCompare(b.name));
            
            if (filteredHorses.length === 0) {
                filesGrid.innerHTML = `
                    <div class="no-results">
                        <h3>Nenhum cavalo encontrado</h3>
                        <p>Tente ajustar seus filtros de busca</p>
                    </div>
                `;
                return;
            }
            
            // Renderizar cada cavalo
            filteredHorses.forEach(horse => {
                const horseCard = document.createElement('div');
                horseCard.className = 'file-card';
                horseCard.innerHTML = `
                    <h3 class="horse-name">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 16H9M14 12H11M12 21C12.9465 21 13.8734 20.7716 14.7087 20.3343C15.544 19.897 16.2623 19.2643 16.8 18.492C17.7895 17.1277 19.8333 14.8 21 13C21.3333 12.3333 22 10.8 22 8.5C22 5.5 20.5 3 17.5 3C15.8333 3 14.5 4.5 14.5 4.5C14.5 4.5 13.5 3 11.5 3C9.5 3 8.5 4 8.5 6C8.5 6 7.5 5 5.5 5C3.5 5 2 7 2 9.5C2 12.5 3.5 14.5 5.5 16.5C7.5 18.5 9.66667 19.3333 11 19.5C11.5 19.6 12 19.5 12 19.5Z" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        ${horse.name}
                    </h3>
                    <div class="horse-details">
                        <div><strong>Raça:</strong> ${horse.breed}</div>
                        <div><strong>Idade:</strong> ${horse.age}</div>
                        <div><strong>Cor:</strong> ${horse.color}</div>
                        <div><strong>Sexo:</strong> ${horse.sex}</div>
                        <div><strong>Proprietário:</strong> ${horse.owner}</div>
                    </div>
                    <div class="file-actions">
                        <button class="btn-small btn-edit" data-id="${horse.id}">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M18.5 2.5C18.8978 2.10217 19.4374 1.87868 20 1.87868C20.5626 1.87868 21.1022 2.10217 21.5 2.5C21.8978 2.89782 22.1213 3.43739 22.1213 4C22.1213 4.56261 21.8978 5.10217 21.5 5.5L12 15L8 16L9 12L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Editar
                        </button>
                        <button class="btn-small btn-pdf" data-id="${horse.id}">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M10 9H9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            PDF
                        </button>
                    </div>
                `;
                filesGrid.appendChild(horseCard);
                
                // Adicionar evento de clique no card
                horseCard.addEventListener('click', (e) => {
                    // Evitar que o clique nos botões abra o modal
                    if (!e.target.closest('.file-actions')) {
                        openHorseDetail(horse.id);
                    }
                });
            });
            
            // Adicionar event listeners para os botões de edição
            document.querySelectorAll('.btn-edit').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const horseId = parseInt(e.currentTarget.getAttribute('data-id'));
                    openEditModal(horseId);
                });
            });
            
            // Adicionar event listeners para os botões de PDF
            document.querySelectorAll('.btn-pdf').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const horseId = parseInt(e.currentTarget.getAttribute('data-id'));
                    exportToPDF(horseId);
                });
            });
        }
        
        // Abrir modal de detalhes do cavalo
        function openHorseDetail(horseId) {
            const horse = horses.find(h => h.id === horseId);
            if (!horse) return;
            
            currentHorseId = horseId;
            horseDetailTitle.innerHTML = `
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M14 16H9M14 12H11M12 21C12.9465 21 13.8734 20.7716 14.7087 20.3343C15.544 19.897 16.2623 19.2643 16.8 18.492C17.7895 17.1277 19.8333 14.8 21 13C21.3333 12.3333 22 10.8 22 8.5C22 5.5 20.5 3 17.5 3C15.8333 3 14.5 4.5 14.5 4.5C14.5 4.5 13.5 3 11.5 3C9.5 3 8.5 4 8.5 6C8.5 6 7.5 5 5.5 5C3.5 5 2 7 2 9.5C2 12.5 3.5 14.5 5.5 16.5C7.5 18.5 9.66667 19.3333 11 19.5C11.5 19.6 12 19.5 12 19.5Z" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Detalhes - ${horse.name}
            `;
            
            // Construir conteúdo dos detalhes
            let detailContent = `
                <div class="detail-section">
                    <h3>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 11C14.2091 11 16 9.20914 16 7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7C8 9.20914 9.79086 11 12 11Z" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Informações Básicas
                    </h3>
                    <div class="detail-info">
                        <p><strong>Nome:</strong> ${horse.name}</p>
                        <p><strong>Identificação:</strong> ${horse.id}</p>
                        <p><strong>Raça:</strong> ${horse.breed}</p>
                        <p><strong>Idade:</strong> ${horse.age}</p>
                        <p><strong>Cor:</strong> ${horse.color}</p>
                        <p><strong>Sexo:</strong> ${horse.sex}</p>
                        <p><strong>Proprietário:</strong> ${horse.owner}</p>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M14 2V8H20" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M16 13H8" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M16 17H8" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M10 9H9H8" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Histórico Médico
                    </h3>
                    <div class="detail-info">
                        <p>${horse.history}</p>
                    </div>
                </div>
            `;
            
            // Adicionar seção de prescrições médicas
            detailContent += `
                <div class="prescription-section">
                    <h3>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5V19.5M19.5 12H4.5" stroke="#2c7fb8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Prescrições Médicas
                    </h3>
                    
                    <div class="prescription-list">
            `;
            
            if (horse.prescriptions && horse.prescriptions.length > 0) {
                horse.prescriptions.forEach(prescription => {
                    detailContent += `
                        <div class="prescription-item">
                            <div class="prescription-header">
                                <div>
                                    <span class="medication-name">${prescription.medication}</span>
                                    <div class="medication-dosage">${prescription.dosage} - ${prescription.frequency}</div>
                                </div>
                                <div class="prescription-actions">
                                    <button class="btn-delete" data-prescription-id="${prescription.id}">
                                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M10 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M14 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        Excluir
                                    </button>
                                </div>
                            </div>
                            <div class="medication-schedule">
                                <div class="schedule-title">Controle de dosagem (${prescription.duration} dias):</div>
                                <div class="days-grid">
                    `;
                    
                    // Gerar quadrados para cada dia
                    prescription.medicationDays.forEach(dayInfo => {
                        const statusClass = dayInfo.status ? dayInfo.status : '';
                        const statusIcon = dayInfo.status === 'applied' ? '✓' : dayInfo.status === 'not-applied' ? '✗' : '';
                        
                        detailContent += `
                            <div>
                                <div class="day-box ${statusClass}" 
                                     data-prescription-id="${prescription.id}" 
                                     data-day="${dayInfo.day}">
                                    ${dayInfo.day}
                                    ${statusIcon ? `<div class="day-status">${statusIcon}</div>` : ''}
                                </div>
                                <div class="day-label">Dia ${dayInfo.day}</div>
                            </div>
                        `;
                    });
                    
                    detailContent += `
                                </div>
                            </div>
                        </div>
                    `;
                });
            } else {
                detailContent += `
                    <div class="detail-info">
                        <p>Nenhuma prescrição médica registrada.</p>
                    </div>
                `;
            }
            
            detailContent += `
                    </div>
                    
                    <div class="add-prescription">
                        <button class="add-prescription-btn" id="showPrescriptionForm">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 5V19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Adicionar Nova Prescrição
                        </button>
            `;
            
            // Formulário de prescrição (inicialmente oculto)
            if (showPrescriptionForm) {
                detailContent += `
                    <div class="prescription-form" id="prescriptionForm">
                        <h4>Nova Prescrição</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="medicationName">Medicamento</label>
                                <input type="text" id="medicationName" required>
                            </div>
                            <div class="form-group">
                                <label for="medicationDosage">Dosagem</label>
                                <input type="text" id="medicationDosage" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="medicationFrequency">Frequência</label>
                                <input type="text" id="medicationFrequency" required>
                            </div>
                            <div class="form-group">
                                <label for="medicationDuration">Duração (dias)</label>
                                <input type="number" id="medicationDuration" min="1" max="90" required>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="cancelPrescription">Cancelar</button>
                            <button type="button" class="btn btn-primary" id="savePrescription">Salvar Prescrição</button>
                        </div>
                    </div>
                `;
            }
            
            detailContent += `
                    </div>
                </div>
            `;
            
            horseDetailContent.innerHTML = detailContent;
            
            // Adicionar event listeners para os quadrados de dias
            document.querySelectorAll('.day-box').forEach(box => {
                box.addEventListener('click', function() {
                    const prescriptionId = parseInt(this.getAttribute('data-prescription-id'));
                    const day = parseInt(this.getAttribute('data-day'));
                    toggleMedicationDay(horseId, prescriptionId, day, this);
                });
            });
            
            // Adicionar event listeners para os botões de exclusão
            document.querySelectorAll('.btn-delete').forEach(btn => {
                btn.addEventListener('click', function() {
                    const prescriptionId = parseInt(this.getAttribute('data-prescription-id'));
                    if (confirm('Tem certeza que deseja excluir esta prescrição?')) {
                        deletePrescription(horseId, prescriptionId);
                    }
                });
            });
            
            // Adicionar event listeners para o formulário de prescrição
            if (showPrescriptionForm) {
                document.getElementById('showPrescriptionForm').addEventListener('click', togglePrescriptionForm);
                document.getElementById('cancelPrescription').addEventListener('click', togglePrescriptionForm);
                document.getElementById('savePrescription').addEventListener('click', savePrescription);
            } else {
                document.getElementById('showPrescriptionForm').addEventListener('click', togglePrescriptionForm);
            }
            
            horseDetailModal.style.display = 'flex';
        }
        
        // Alternar status do dia da medicação
        function toggleMedicationDay(horseId, prescriptionId, day, element) {
            const horse = horses.find(h => h.id === horseId);
            if (!horse) return;
            
            const prescription = horse.prescriptions.find(p => p.id === prescriptionId);
            if (!prescription) return;
            
            const dayInfo = prescription.medicationDays.find(d => d.day === day);
            if (!dayInfo) return;
            
            // Ciclo de estados: null -> applied -> not-applied -> null
            if (dayInfo.status === null) {
                dayInfo.status = "applied";
                element.classList.add('applied');
                element.innerHTML = `${day}<div class="day-status">✓</div>`;
            } else if (dayInfo.status === "applied") {
                dayInfo.status = "not-applied";
                element.classList.remove('applied');
                element.classList.add('not-applied');
                element.innerHTML = `${day}<div class="day-status">✗</div>`;
            } else {
                dayInfo.status = null;
                element.classList.remove('not-applied');
                element.innerHTML = day;
            }
        }
        
        // Alternar visibilidade do formulário de prescrição
        function togglePrescriptionForm() {
            showPrescriptionForm = !showPrescriptionForm;
            openHorseDetail(currentHorseId);
        }
        
        // Salvar nova prescrição
        function savePrescription() {
            const medicationName = document.getElementById('medicationName').value;
            const medicationDosage = document.getElementById('medicationDosage').value;
            const medicationFrequency = document.getElementById('medicationFrequency').value;
            const medicationDuration = parseInt(document.getElementById('medicationDuration').value);
            
            if (!medicationName || !medicationDosage || !medicationFrequency || !medicationDuration) {
                alert('Por favor, preencha todos os campos.');
                return;
            }
            
            const horse = horses.find(h => h.id === currentHorseId);
            if (!horse) return;
            
            // Gerar ID único para a prescrição
            const newPrescriptionId = horse.prescriptions.length > 0 
                ? Math.max(...horse.prescriptions.map(p => p.id)) + 1 
                : 1;
            
            // Criar array de dias
            const medicationDays = Array.from({length: medicationDuration}, (_, i) => ({
                day: i + 1,
                status: null
            }));
            
            // Adicionar nova prescrição
            horse.prescriptions.push({
                id: newPrescriptionId,
                medication: medicationName,
                dosage: medicationDosage,
                frequency: medicationFrequency,
                duration: medicationDuration,
                startDate: new Date().toISOString().split('T')[0],
                medicationDays: medicationDays
            });
            
            // Fechar formulário e atualizar view
            showPrescriptionForm = false;
            openHorseDetail(currentHorseId);
            alert('Prescrição adicionada com sucesso!');
        }
        
        // Excluir prescrição
        function deletePrescription(horseId, prescriptionId) {
            const horse = horses.find(h => h.id === horseId);
            if (!horse) return;
            
            const prescriptionIndex = horse.prescriptions.findIndex(p => p.id === prescriptionId);
            if (prescriptionIndex === -1) return;
            
            horse.prescriptions.splice(prescriptionIndex, 1);
            openHorseDetail(horseId);
            alert('Prescrição excluída com sucesso!');
        }
        
        // Abrir modal para adicionar/editar cavalo
        function openAddModal() {
            currentHorseId = null;
            modalTitle.textContent = 'Adicionar Novo Cavalo';
            horseForm.reset();
            horseModal.style.display = 'flex';
        }
        
        function openEditModal(horseId) {
            const horse = horses.find(h => h.id === horseId);
            if (!horse) return;
            
            currentHorseId = horseId;
            modalTitle.textContent = 'Editar Ficha do Cavalo';
            
            document.getElementById('horseName').value = horse.name;
            document.getElementById('horseId').value = horse.id;
            document.getElementById('horseBreed').value = horse.breed;
            document.getElementById('horseAge').value = horse.age;
            document.getElementById('horseColor').value = horse.color;
            document.getElementById('horseSex').value = horse.sex;
            document.getElementById('horseOwner').value = horse.owner;
            document.getElementById('horseHistory').value = horse.history;
            
            horseModal.style.display = 'flex';
        }
        
        // Fechar modais
        function closeHorseModal() {
            horseModal.style.display = 'none';
        }
        
        function closeHorseDetailModal() {
            horseDetailModal.style.display = 'none';
            showPrescriptionForm = false;
        }
        
        // Salvar cavalo (adicionar ou editar)
        function saveHorse(e) {
            e.preventDefault();
            
            const horseData = {
                name: document.getElementById('horseName').value,
                id: currentHorseId ? currentHorseId : Math.max(...horses.map(h => h.id)) + 1,
                breed: document.getElementById('horseBreed').value,
                age: document.getElementById('horseAge').value,
                color: document.getElementById('horseColor').value,
                sex: document.getElementById('horseSex').value,
                owner: document.getElementById('horseOwner').value,
                history: document.getElementById('horseHistory').value,
                prescriptions: currentHorseId ? horses.find(h => h.id === currentHorseId).prescriptions : []
            };
            
            if (currentHorseId) {
                // Editar cavalo existente
                const index = horses.findIndex(h => h.id === currentHorseId);
                if (index !== -1) {
                    horses[index] = horseData;
                }
            } else {
                // Adicionar novo cavalo
                horses.push(horseData);
            }
            
            closeHorseModal();
            renderHorses();
            alert('Ficha salva com sucesso!');
        }
        
        // Exportar para PDF
        function exportToPDF(horseId) {
            const horse = horses.find(h => h.id === horseId);
            if (!horse) return;
            
            alert(`Gerando PDF para ${horse.name}...\n\nEm um sistema real, isso geraria um arquivo PDF com todas as informações da ficha.`);
            // Em um sistema real, aqui você usaria uma biblioteca como jsPDF para gerar o PDF
        }
        
        // Exportar todos para PDF
        function exportAllToPDF() {
            alert('Exportando todas as fichas para PDF...\n\nEm um sistema real, isso geraria um arquivo ZIP com PDFs de todos os cavalos.');
            // Em um sistema real, aqui você geraria PDFs para todos os cavalos
        }
        
        // Fazer logout
        function logout() {
            if (confirm('Tem certeza que deseja sair do sistema?')) {
                showLoginPage();
            }
        }
        
        // ========== INICIALIZAÇÃO ==========
        function init() {
            // Event Listeners da tela de arquivos
            btnAddHorse.addEventListener('click', openAddModal);
            btnExportAll.addEventListener('click', exportAllToPDF);
            closeModal.addEventListener('click', closeHorseModal);
            btnCancel.addEventListener('click', closeHorseModal);
            horseForm.addEventListener('submit', saveHorse);
            searchInput.addEventListener('input', renderHorses);
            btnLogout.addEventListener('click', logout);
            
            // NOVO: Event Listener para o botão do laboratório
            btnLaboratory.addEventListener('click', function() {
                window.location.href = 'lab.html';
            });
            
            // Event Listeners do modal de detalhes
            closeDetailModal.addEventListener('click', closeHorseDetailModal);
            btnCloseDetail.addEventListener('click', closeHorseDetailModal);
            btnEditHorse.addEventListener('click', () => {
                closeHorseDetailModal();
                openEditModal(currentHorseId);
            });
            
            // Fechar modais ao clicar fora deles
            window.addEventListener('click', (e) => {
                if (e.target === horseModal) {
                    closeHorseModal();
                }
                if (e.target === horseDetailModal) {
                    closeHorseDetailModal();
                }
            });
            
            // Limpar mensagens quando o usuário começar a digitar (login)
            document.getElementById('username').addEventListener('input', function() {
                errorMessage.style.display = 'none';
                successMessage.style.display = 'none';
            });
            
            document.getElementById('password').addEventListener('input', function() {
                errorMessage.style.display = 'none';
                successMessage.style.display = 'none';
            });
        }
        
        // Iniciar a aplicação
        init();
    </script>
</body>
</html>
